<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="Course_work.AddTaskPage"
    BackgroundColor="#FFFFFF"
    Padding="0">

    <ContentPage.Resources>
        <ResourceDictionary>

           <Style x:Key="TitleEntryBorderStyle" TargetType="Border">
    <Setter Property="Stroke" Value="#CCCCCC" />
    <Setter Property="StrokeThickness" Value="2" />

    <Style.Triggers>

        <DataTrigger TargetType="Border"
                     Binding="{Binding SelectedPriority}"
                     Value="HighUrgent">
            <Setter Property="Stroke" Value="#d55043" />
        </DataTrigger>

        <DataTrigger TargetType="Border"
                     Binding="{Binding SelectedPriority}"
                     Value="High">
            <Setter Property="Stroke" Value="#FFF09515" />
        </DataTrigger>

        <DataTrigger TargetType="Border"
                     Binding="{Binding SelectedPriority}"
                     Value="Urgent">
            <Setter Property="Stroke" Value="#FFBD59" />
        </DataTrigger>

        <DataTrigger TargetType="Border"
                     Binding="{Binding SelectedPriority}"
                     Value="Low">
            <Setter Property="Stroke" Value="#999999" />
        </DataTrigger>

        <DataTrigger TargetType="Border"
                     Binding="{Binding SelectedPriority}"
                     Value="{x:Null}">
            <Setter Property="Stroke" Value="#CCCCCC" />
        </DataTrigger>

    </Style.Triggers>
</Style>

        </ResourceDictionary>
    </ContentPage.Resources>


    <Grid RowDefinitions="Auto,*">

        <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Padding="0,10">
            <Label Text="Добавить задачу"
                   FontSize="28"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   TextColor="Black"/>
            <Button Grid.Column="1"
                    BackgroundColor="Transparent"
                    Padding="0"
                    Margin="10,0,10,0"
                    Clicked="OnCloseTapped">
                <Button.ImageSource>
                    <FontImageSource Glyph="✕" Color="#777777" Size="28"/>
                </Button.ImageSource>
            </Button>
        </Grid>

        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="12" Padding="20">

     <Border BackgroundColor="#ffffff"
        Style="{StaticResource TitleEntryBorderStyle}"
        StrokeShape="RoundRectangle 8"
        Padding="0"
        HeightRequest="55">

    <Entry x:Name="TitleEntry"
           Placeholder="Введите название:"
           FontSize="20"
           BackgroundColor="Transparent"
           TextColor="Black"
           HorizontalOptions="FillAndExpand"
           VerticalOptions="Center"
           Margin="12,0"/>
</Border>

                <Label x:Name="PickedDateLabel"
                       Text=""
                       FontSize="14"
                       TextColor="Black"
                       IsVisible="False"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center" />

                <Border BackgroundColor="#f5f5f5"
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 8"
                        HeightRequest="130">
                    <Editor x:Name="DescriptionEditor"
                            Placeholder="Добавьте описание..."
                            FontSize="18"
                            BackgroundColor="Transparent"
                            TextColor="Black"
                            Margin="12,5"
                            AutoSize="TextChanges"/>
                </Border>

                <Grid ColumnSpacing="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Button Text="Время"
                            Grid.Column="0"
                            x:Name="DateButton"
                            BackgroundColor="#ffbd59"
                            TextColor="White"
                            CornerRadius="15"
                            HeightRequest="50"
                            Clicked="OnDateClicked"/>

                    <Button Text="Приоритет"
                            Grid.Column="1"
                            x:Name="PriorityButton"
                            BackgroundColor="#d55043"
                            TextColor="White"
                            CornerRadius="15"
                            HeightRequest="55"
                            Clicked="OnPriorityClicked"/>

                    <Button Text="Уведомления"
                            Grid.Column="2"
                            BackgroundColor="#0097b2"
                            TextColor="White"
                            CornerRadius="15"
                            HeightRequest="55"/>
                </Grid>

                <Button Text="Добавить"
                        BackgroundColor="#468966"
                        TextColor="White"
                        FontSize="22"
                        CornerRadius="20"
                        HeightRequest="48"
                        Margin="0,10,0,0"
                        Clicked="OnAddTaskConfirm"/>
            </VerticalStackLayout>
        </ScrollView>

        <Grid Grid.RowSpan="2"
              x:Name="PopupOverlay"
              IsVisible="False"
              BackgroundColor="#80000000"
              HorizontalOptions="Fill"
              VerticalOptions="Fill"
              Padding="0"
              ZIndex="50">

            <Grid HorizontalOptions="Center"
                  VerticalOptions="Center"
                  WidthRequest="320">

                <Border x:Name="PriorityPopup"
                        BackgroundColor="White"
                        StrokeShape="RoundRectangle 18"
                        Padding="18"
                        IsVisible="False">

                    <VerticalStackLayout Spacing="14">
                        <Grid ColumnDefinitions="*,Auto">
                            <Label Text="Select Priority"
                                   FontSize="20"
                                   HorizontalOptions="FillAndExpand"
                                   HorizontalTextAlignment="Center"
                                   VerticalOptions="Center"/>

                            <Button Grid.Column="1"
                                    BackgroundColor="Transparent"
                                    Padding="0"
                                    Clicked="OnClosePriorityPopup">
                                <Button.ImageSource>
                                    <FontImageSource Glyph="✕" Color="#444" Size="22"/>
                                </Button.ImageSource>
                            </Button>
                        </Grid>

                        <Button Text="Важно и срочно"
                                BackgroundColor="#d55043"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnPrioritySelected"
                                CommandParameter="HighUrgent"/>

                        <Button Text="Важно и не срочно"
                                BackgroundColor="#FFF09515"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnPrioritySelected"
                                CommandParameter="High"/>

                        <Button Text="Не важно и срочно"
                                BackgroundColor="#FFFCCC3C"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnPrioritySelected"
                                CommandParameter="Urgent"/>

                        <Button Text="Не важно и не срочно"
                                BackgroundColor="#cccccc"
                                TextColor="Black"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnPrioritySelected"
                                CommandParameter="Low"/>
                    </VerticalStackLayout>
                </Border>

                <Border x:Name="DatePopupOverlay"
                        BackgroundColor="White"
                        StrokeShape="RoundRectangle 18"
                        Padding="18"
                        IsVisible="False">

                    <VerticalStackLayout Spacing="12">

                        <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,4">
                            <Label Text="Select Date"
                                   FontSize="20"
                                   HorizontalOptions="FillAndExpand"
                                   HorizontalTextAlignment="Center"
                                   VerticalOptions="Center"/>
                            <Button Grid.Column="1"
                                    BackgroundColor="Transparent"
                                    Padding="0"
                                    Clicked="OnCloseDatePopup">
                                <Button.ImageSource>
                                    <FontImageSource Glyph="✕" Color="#444" Size="22"/>
                                </Button.ImageSource>
                            </Button>
                        </Grid>

                        <Button Text="Сегодня"
                                BackgroundColor="#468966"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnSelectToday"/>

                        <Button Text="Завтра"
                                BackgroundColor="#F0AD4E"
                                TextColor="Black"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnSelectTomorrow"/>

                        <Button Text="Следующая неделя"
                                BackgroundColor="#D9534F"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnSelectNextWeek"/>

                        <Button Text="Без срока"
                                BackgroundColor="#BDBDBD"
                                TextColor="Black"
                                CornerRadius="10"
                                HeightRequest="45"
                                Clicked="OnSelectNoDate"/>

                        <DatePicker x:Name="CustomDatePicker"
                                    DateSelected="OnCustomDatePicked"
                                    HorizontalOptions="Center"
                                    WidthRequest="220"/>

                        <TimePicker x:Name="CustomTimePicker"
                                    Format="HH:mm"
                                    PropertyChanged="OnCustomTimePropertyChanged"
                                    HorizontalOptions="Center"
                                    WidthRequest="220"/>

                    </VerticalStackLayout>
                </Border>

            </Grid>
        </Grid>
    </Grid>
</ContentPage>